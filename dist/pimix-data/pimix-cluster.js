const recluster=require("recluster"),path=require("path"),os=require("os"),_=require("lodash"),nbCPUs=os.cpus().length,maxCPUs=process.env.MAX_WORKERS,nbWorkers=nbCPUs>maxCPUs?maxCPUs:nbCPUs,cluster=recluster(path.join(__dirname,"rest.js"),{workers:nbWorkers,timeout:1});console.log(" ██████ ██      ██    ██ ███████ ████████ ███████ ██████  "),console.log("██      ██      ██    ██ ██         ██    ██      ██   ██ "),console.log("██      ██      ██    ██ ███████    ██    █████   ██████  "),console.log("██      ██      ██    ██      ██    ██    ██      ██   ██ "),console.log(" ██████ ███████  ██████  ███████    ██    ███████ ██   ██ "),_.isNil(maxCPUs)||console.log(`Max workers set to ${maxCPUs}. Available workers: ${nbCPUs}`),console.log(`Spawned cluster with ** ${nbWorkers} workers **`),cluster.run(),process.on("SIGUSR2",(()=>{console.log("Got SIGUSR2, reloading cluster..."),cluster.reload()}));