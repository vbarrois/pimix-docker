!function(e){var t={};function n(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=38)}([function(e,t,n){"use strict";n.r(t);const s=n(2),i=n(12).production,o={};let r;r=i.use_env_variable?new s(process.env[i.use_env_variable],i):new s(i.database,i.username,i.password,i);const a=n(13);a.keys().map(a).forEach(e=>{const t=e(r,s);o[t.name]=t}),Object.keys(o).forEach(e=>{o[e].associate&&o[e].associate(o)}),o.sequelize=r,o.Sequelize=s,t.default=o},function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("sequelize")},function(e,t){e.exports=require("express")},,,function(e,t){e.exports=require("jimp")},,function(e,t){e.exports=require("path")},,,,function(e){e.exports=JSON.parse('{"development":{"dialect":"sqlite","seederStorage":"sequelize","storage":"./pimix.sqlite3","logging":false},"production":{"dialect":"sqlite","storage":"/home/pimix.sqlite3","seederStorage":"sequelize","logging":false}}')},function(e,t,n){var s={"./artist.js":14,"./artistgenre.js":15,"./artistrelated.js":16,"./genre.js":17,"./song.js":18,"./songartist.js":19,"./songgenre.js":20,"./songlog.js":21,"./songloguser.js":22,"./user.js":23};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=o,e.exports=i,i.id=13},function(e,t,n){"use strict";e.exports=(e,t)=>{const n=e.define("Artist",{name:t.STRING,state:t.BOOLEAN,spotifyId:t.STRING,popularity:t.INTEGER,followers:t.INTEGER});return n.associate=function(e){e.Artist.hasMany(e.ArtistRelated,{as:"ArtistRelations",foreignKey:"artist_id"})},n}},function(e,t,n){"use strict";e.exports=(e,t)=>{const n=e.define("ArtistGenre",{artist_id:t.INTEGER,genre_id:t.INTEGER},{indexes:[{unique:!0,fields:["artist_id","genre_id"]}]});return n.associate=function(e){e.Artist.belongsToMany(e.Genre,{as:"Genres",through:{model:n,unique:!1},foreignKey:"artist_id"}),e.Genre.belongsToMany(e.Artist,{as:"Artists",through:{model:n,unique:!1},foreignKey:"genre_id"})},n}},function(e,t,n){"use strict";e.exports=(e,t)=>e.define("ArtistRelated",{artist_id:t.INTEGER,name:t.STRING,spotifyId:t.STRING,followers:t.INTEGER,popularity:t.INTEGER},{freezeTableName:!0})},function(e,t,n){"use strict";e.exports=(e,t)=>e.define("Genre",{name:t.STRING,state:t.BOOLEAN})},function(e,t,n){"use strict";e.exports=(e,t)=>{const n=e.define("Song",{filepath:t.STRING,filename:t.STRING,title:t.STRING,album:t.STRING,year:t.INTEGER,bitrate:t.INTEGER,duration:t.DOUBLE,samplerate:t.INTEGER,size:t.INTEGER,ino:t.INTEGER,birth:t.DATE},{indexes:[{unique:!0,fields:["filepath","filename"]}]});return n.beforeValidate(e=>{e.filepath&&(e.filepath=e.filepath.replace(/\\/g,"/"))}),n.associate=function(e){e.Song.hasMany(e.SongLog,{as:"SongLogs",foreignKey:"songid"})},n}},function(e,t,n){"use strict";e.exports=(e,t)=>{const n=e.define("SongArtist",{song_id:t.INTEGER,artist_id:t.INTEGER},{indexes:[{unique:!0,fields:["song_id","artist_id"]}]});return n.associate=function(e){e.Song.belongsToMany(e.Artist,{as:"Artists",through:{model:n,unique:!1},foreignKey:"song_id"}),e.Artist.belongsToMany(e.Song,{as:"Songs",through:{model:n,unique:!1},foreignKey:"artist_id"})},n}},function(e,t,n){"use strict";e.exports=(e,t)=>{const n=e.define("SongGenre",{song_id:t.INTEGER,genre_id:t.INTEGER},{indexes:[{unique:!0,fields:["song_id","genre_id"]}]});return n.associate=function(e){e.Song.belongsToMany(e.Genre,{as:"Genres",through:{model:n,unique:!1},foreignKey:"song_id"}),e.Genre.belongsToMany(e.Song,{as:"Songs",through:{model:n,unique:!1},foreignKey:"genre_id"})},n}},function(e,t,n){"use strict";e.exports=(e,t)=>{const n=e.define("SongLog",{sessionid:t.STRING(36),songid:t.INTEGER,listenratio:t.FLOAT,origin:t.STRING(10)});return n.associate=function(e){n.belongsTo(e.Song,{foreignKey:"songid"})},n}},function(e,t,n){"use strict";e.exports=(e,t)=>{const n=e.define("SongLogUser",{logid:t.INTEGER,userid:t.INTEGER,vote:t.INTEGER});return n.associate=function(e){n.belongsTo(e.SongLog,{foreignKey:"logid"}),n.belongsTo(e.User,{foreignKey:"userid"})},n}},function(e,t,n){"use strict";var s=n(24);e.exports=(e,t)=>{const n=e.define("User",{login:t.STRING,password:t.STRING,name:t.STRING,rights:t.INTEGER});return n.prototype.validPassword=function(e){return s.compareSync(e,this.password)},n.beforeCreate(e=>(void 0!==e.login&&(e.login=e.login.trim()),void 0!==e.name&&(e.name=e.name.trim()),e)),n.afterValidate(e=>{void 0!==e.password&&(e.password=s.hashSync(e.password,s.genSaltSync(10),null))}),n}},function(e,t){e.exports=require("bcryptjs")},function(e){e.exports=JSON.parse('{"name":"pimix-data","version":"1.0.8","description":"Pimix REST API from data management","main":"index.js","scripts":{"scanner":"nodemon ./dist/scanner.js","data":"nodemon ./dist/data.js","test":"echo \\"Error: no test specified\\" && exit 1","lint":"eslint \\"src/**/*.js\\" --ignore-pattern node_modules/ ","build":"rm -rf dist && webpack","start":"npx concurrently -k -n \\"data,scanner\\" -p \\"[{name}]\\" -c \\"yellow,green\\" \\"npm run data\\" \\"npm run scanner\\""},"repository":{"type":"git","url":"git+https://github.com/vbarrois/pimix-data.git"},"author":"Vincent Barrois","license":"ISC","bugs":{"url":"https://github.com/vbarrois/pimix-data/issues"},"homepage":"https://github.com/vbarrois/pimix-data#readme","dependencies":{"@babel/core":"^7.9.6","@babel/preset-env":"^7.9.6","babel-loader":"^8.1.0","bcryptjs":"^2.4.3","bull":"^3.11.0","child_process":"^1.0.2","chokidar":"^3.2.2","colors":"^1.4.0","concurrently":"^5.1.0","copy-webpack-plugin":"^5.1.1","eslint":"^6.6.0","eslint-config-standard":"^14.1.0","eslint-loader":"^4.0.2","eslint-plugin-import":"^2.18.2","eslint-plugin-node":"^10.0.0","eslint-plugin-promise":"^4.2.1","eslint-plugin-standard":"^4.0.1","express":"^4.17.1","jimp":"^0.10.0","moment":"^2.24.0","music-metadata":"^4.8.2","node-spotify-api":"^1.1.1","nodemon":"^1.19.4","sequelize":"^5.21.1","socket.io":"^2.3.0","spotify-web-api-node":"^4.0.0","sqlite3":"^4.1.1","webpack":"^4.43.0","webpack-cli":"^3.3.11","webpack-dev-middleware":"^3.7.2","webpack-hot-middleware":"^2.25.0","webpack-node-externals":"^1.7.2"}}')},,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"addSongLog",(function(){return i})),n.d(t,"updateSongLog",(function(){return o})),n.d(t,"addSongUserLog",(function(){return r}));var s=n(0);const i=e=>s.default.SongLog.create(e),o=e=>s.default.SongLog.update({listenratio:e.listenratio},{where:{id:e.id}}),r=e=>s.default.SongLogUser.create(e)},function(e,t){e.exports=require("body-parser")},,,,function(e,t,n){"use strict";n.r(t);var s=n(8),i=n.n(s),o=n(3),r=n.n(o),a=n(0);const d=r.a.Router();d.post("/api/login",(e,t)=>{a.default.User.findOne({where:{login:e.body.login}}).then(n=>n?n.validPassword(e.body.password)?t.status(200).send({connected:!0,user:n}):t.status(200).send({connected:!1,message:"Incorrect password."}):t.status(200).send({connected:!1,message:"Incorrect login."}))}),d.post("/api/pseudo",(e,t)=>{a.default.User.findOrCreate({where:{login:e.body.login},defaults:{login:e.body.login,name:e.body.login,rights:0}}).then(e=>{const n=e[0].dataValues;return n?t.status(200).send({connected:!0,user:n}):t.status(200).send({connected:!1,message:"Incorrect pseudo."})})});var u=d,l=n(2),g=n.n(l);const S=r.a.Router();function c(e){return new Promise((t,n)=>{const s="SELECT S.id AS id, S.filename AS filename FROM Songs S, SongGenres SG, Genres G WHERE SG.song_id = S.id AND SG.genre_id = G.id AND G.state = 1 "+(void 0!==e?"AND S.id <> "+e.id+" ":"")+"ORDER BY RANDOM() LIMIT 0, 1";a.default.sequelize.query(s,{type:g.a.QueryTypes.SELECT}).then(e=>{if(console.log("NEXT (Shuffle but not played yet) : "),console.log(e),e.length>0){return p(e[0].id)}}).then(t).catch(n)})}function p(e){return a.default.Song.findOne({where:{id:e},attributes:["id","filepath","filename","title","album","year","duration"],include:[{model:a.default.Artist,as:"Artists",attributes:["id","name"],required:!1,through:{attributes:[]}},{model:a.default.Genre,as:"Genres",attributes:["id","name"],required:!1,through:{attributes:[]}},{model:a.default.SongLog,as:"SongLogs",attributes:["listenratio"]}]})}S.post("/api/genius/next",(e,t)=>{var n;t.header("Content-Type","application/json; charset=utf-8"),e.body.shuffle?c(e.body.current).then(e=>t.status(200).send({origin:"shuffle",song:e})).catch(e=>(console.log("There was an error querying genius next",JSON.stringify(e)),t.status(500).send(e))):(n=e.body.current,new Promise((e,t)=>{const s="SELECT S.id AS id, S.filename AS filename, count() AS played, "+(void 0!==n?"ABS(S.year-"+n.year+") AS yeardelta, ":"")+"(AVG(SL.listenratio)*2-.4)*(1-1.0/(count(SL.listenratio)+2)) AS avgduration FROM Songs S,SongLogs SL, SongGenres SG, Genres G WHERE S.id = SL.songid AND SG.song_id = S.id AND SG.genre_id = G.id AND G.state = 1 "+(void 0!==n?"AND S.id <> "+n.id+" ":"")+'AND S.id NOT IN (SELECT SGLG.songid from SongLogs SGLG where datetime(SGLG.createdAt) >= datetime("now", "-2 Hour")) GROUP BY S.id ORDER BY avgduration DESC, '+(void 0!==n?"yeardelta ASC, ":"")+"S.id DESC LIMIT 0, 1";a.default.sequelize.query(s,{type:g.a.QueryTypes.SELECT}).then(e=>(console.log("NEXT (Genius) : "),console.log(e),e.length>0?p(e[0].id):c())).then(e).catch(t)})).then(e=>t.status(200).send({origin:"genius",song:e})).catch(e=>(console.log("There was an error querying genius next",JSON.stringify(e)),t.status(500).send(e)))});var f=S,A=n(1),y=n.n(A);const _=n(33),E=r.a.Router();E.post("/api/log/songplayed",(e,t)=>{t.header("Content-Type","application/json; charset=utf-8");const n=e.body.item,s=e.body.sessionid,i=e.body.item.origin;null!==n&&null!==n.song&&_.addSongLog({sessionid:s,songid:n.song.id,origin:i}).then(e=>{const t=e.dataValues,s=[];return y.a.forEach(n.votes,e=>{const n={logid:t.id,userid:e.userid,vote:e.points};s.push(_.addSongUserLog(n))}),new Promise((e,n)=>{Promise.all(s).then(e(t)).catch(n)})}).then(e=>t.status(200).send(e)).catch(e=>(console.log("Cannot create song logs",JSON.stringify(e)),t.status(500).send(e)))}),E.post("/api/log/songcomplete",(e,t)=>{t.header("Content-Type","application/json; charset=utf-8");const n=e.body.id,s=e.body.listenratio;_.updateSongLog({id:n,listenratio:s}).then(()=>t.status(200).end()).catch(e=>(console.log("Cannot update song logs",JSON.stringify(e)),t.status(500).send(e)))});var h=E;const m=r.a.Router(),G=g.a.Op,T={attributes:["id","filepath","filename","title","album","year","duration","birth"],include:[{model:a.default.Artist,as:"Artists",attributes:["id","name"],required:!1,through:{attributes:[]}},{model:a.default.Genre,as:"Genres",attributes:["id","name"],required:!1,through:{attributes:[]}},{model:a.default.SongLog,as:"SongLogs",attributes:["listenratio"]}]};m.post("/api/search/library",(e,t)=>{var n=e.body.keywords;t.header("Content-Type","application/json; charset=utf-8"),a.default.Song.findAll({attributes:["id","filepath","filename","title","album","year","duration"],where:{[G.or]:[{title:{[G.like]:"%"+n+"%"}},{filename:{[G.like]:"%"+n+"%"}},{year:n},{"$Genres.name$":{[G.like]:"%"+n+"%"}},{"$Artists.name$":{[G.like]:"%"+n+"%"}}]},include:[{model:a.default.Artist,as:"Artists",attributes:["id","name"],required:!1,through:{attributes:[]}},{model:a.default.Genre,as:"Genres",attributes:["id","name"],required:!1,through:{attributes:[]}},{model:a.default.SongLog,as:"SongLogs",attributes:["listenratio"]}]}).then(e=>t.send(e)).catch(e=>(console.log("There was an error querying songs",JSON.stringify(e)),t.status(500).send(e)))}),m.post("/api/search/:mode",(e,t)=>{const n=e.body.current,s=void 0!==n?n.year:0,i=void 0!==n?n.id:0,o=e.body.sessionid;var r;switch(e.params.mode){case"listenratio":r="SELECT SL.songid AS id, AVG(SL.listenratio) AS listenratio, COUNT(SL.songid) AS played FROM SongLogs SL GROUP BY SL.songid ORDER BY listenratio desc, played DESC";break;case"mostplayed":r="SELECT SL.songid AS id, COUNT(SL.songid) AS played FROM SongLogs SL GROUP BY SL.songid ORDER BY played DESC, SL.createdAt DESC";break;case"mostvoted":r="SELECT SL.songid AS id, SUM(SLU.vote) AS vote FROM SongLogUsers SLU, SongLogs SL WHERE SLU.logid = SL.id GROUP BY SL.songid ORDER BY vote DESC, SL.createdAt DESC";break;case"lastadded":r="SELECT S.id AS id, S.birth AS birth FROM Songs S ORDER BY birth DESC, S.id DESC";break;case"sameartist":r="SELECT SA.song_id AS id, SA.artist_id AS artistid, ABS(S.year-"+s+") AS decay FROM SongArtists SA, Songs S WHERE S.id = SA.song_id AND S.id <> "+i+" AND SA.artist_id in ("+y.a.map(n.Artists,e=>e.id).toString()+") ORDER BY decay ASC, artistid ASC, SA.song_id DESC";break;case"samegenre":r="SELECT SG.song_id AS id, SG.genre_id AS genreid, ABS(S.year-"+s+") AS decay FROM SongGenres SG, Songs S WHERE S.id = SG.song_id AND S.id <> "+i+" AND SG.genre_id in ("+y.a.map(n.Genres,e=>e.id).toString()+") ORDER BY decay ASC, genreid ASC, SG.song_id DESC";break;case"sameyear":r="SELECT S.id AS id FROM Songs S WHERE S.year = "+s+" AND S.id <> "+i+" ORDER BY S.id DESC";break;case"never":r="SELECT S.id AS id, ABS(S.year-"+s+") AS yeardelta FROM Songs S WHERE S.id NOT IN ( SELECT songid FROM SongLogs) ORDER BY yeardelta ASC, S.id DESC";break;case"genius":r="SELECT S.id AS id, count() AS played, ABS(S.year-"+s+") AS yeardelta, (AVG(SL.listenratio)*2-.4)*(1-1.0/(count(SL.listenratio)+2)) AS avgduration FROM Songs S, SongLogs SL WHERE S.id = SL.songid AND S.id <> "+i+" AND S.id NOT IN ( SELECT songid FROM SongLogs WHERE sessionid = '"+o+"') GROUP BY S.id ORDER BY avgduration DESC, yeardelta ASC, S.id DESC";break;case"artistrelated":r="SELECT S.id AS id FROM SongArtists SA, ArtistRelated AR, Artists A, Songs S, SongArtists SA2, SongGenres SG, Genres G WHERE SA.artist_id = AR.artist_id AND A.spotifyId = AR.spotifyId AND A.id = SA2.artist_id AND SA2.song_id = S.id AND SG.song_id = S.id AND SG.genre_id = G.id AND G.state = 1 AND S.id not in (SELECT songid from SongLogs WHERE sessionid = '"+o+"') AND SA.song_id = "+i;break;case"commongenres":r="SELECT S.id as id, COUNT(G.id) as CommonGenre FROM SongArtists SA, ArtistGenres AG, Genres G, ArtistGenres AG2, SongArtists SA2, Songs S WHERE AG.artist_id = SA.artist_id AND AG2.genre_id = G.id AND AG2.genre_id = AG.genre_id AND AG2.artist_id = SA2.artist_id AND S.id = SA2.song_id AND S.id NOT IN (SELECT songid from SongLogs WHERE sessionid = '"+o+"') AND SA.song_id = "+i+" GROUP BY S.id ORDER BY CommonGenre DESC, S.id DESC"}(function(e,t){return new Promise((e,n)=>{const s=t+" LIMIT 0, 100";a.default.sequelize.query(s,{type:g.a.QueryTypes.SELECT}).then(e=>function(e){return new Promise((t,n)=>{const s=y.a.map(e,e=>e.id);var i=T;i.where={id:{[G.in]:s}},a.default.Song.findAll(i).then(n=>{const s=y.a.map(e,e=>y.a.merge(e,y.a.find(y.a.map(n,e=>e.get({plain:!0})),t=>t.id===e.id)));t(s)}).catch(n)})}(e)).then(t=>{e(t)}).catch(n)})})(0,r).then(e=>{t.send(e)}).catch(n=>(console.log("There was an error querying "+e.params.mode,JSON.stringify(n)),t.status(500).send(n)))});var b=m,R=n(6),N=n.n(R);const L=r.a.Router(),O=process.env.COVER_FOLDER||"/home/covers";function C(e,t){return new Promise((n,s)=>{a.default.Song.findOne({where:{id:e}}).then(e=>{const o=O+(t?"/thumbs/":"/")+i.a.parse(e.filename).name+".jpg";N.a.read(o).then(e=>{e.getBuffer(N.a.MIME_JPEG,(e,t)=>{e?s(e):n(t)})}).catch(e=>{s(e)})}).catch(e=>{s(e)})})}L.get("/api/songs",(e,t)=>{t.header("Content-Type","application/json; charset=utf-8"),a.default.Song.findAll({include:[{model:a.default.Genre,as:"Genres"},{model:a.default.Artist,as:"Artists"}]}).then(e=>t.send(e)).catch(e=>(console.log("There was an error querying songs",JSON.stringify(e)),t.status(500).send(e)))}),L.get("/api/songs/genre/:genre",(e,t)=>{t.header("Content-Type","application/json; charset=utf-8"),a.default.Song.findAll({where:{"$Genres.id$":e.params.genre.split(",")},include:[{model:a.default.Genre,as:"Genres",required:!1},{model:a.default.Artist,as:"Artists",required:!1}]}).then(e=>t.send(e)).catch(e=>(console.log("There was an error querying songs",JSON.stringify(e)),t.status(500).send(e)))}),L.get("/api/songs/artist/:artist",(e,t)=>{t.header("Content-Type","application/json; charset=utf-8"),a.default.Song.findAll({where:{"$Artists.id$":e.params.artist.split(",")},include:[{model:a.default.Genre,as:"Genres",required:!1},{model:a.default.Artist,as:"Artists",required:!1}]}).then(e=>t.send(e)).catch(e=>(console.log("There was an error querying songs",JSON.stringify(e)),t.status(500).send(e)))}),L.get("/api/song/thumb/:id",(e,t)=>{C(e.params.id,!0).then(e=>{t.set("Content-Type",N.a.MIME_JPEG),t.status(200).send(e)}).catch(e=>{console.log(e),t.status(404).end()})}),L.get("/api/song/cover/:id",(e,t)=>{C(e.params.id,!1).then(e=>{t.set("Content-Type",N.a.MIME_JPEG),t.status(200).send(e)}).catch(()=>{t.status(404).end()})});var D=L;const v=r.a.Router();v.get("/api/genres",(e,t)=>{t.header("Content-Type","application/json; charset=utf-8");a.default.sequelize.query("SELECT G.id, G.name, G.state, COUNT(SG.song_id) AS songs, MIN(S.year) AS yearfrom, MAX(S.year) AS yearto FROM SongGenres SG, Genres G, Songs S WHERE SG.genre_id = G.id AND SG.song_id = S.id GROUP BY G.id",{type:g.a.QueryTypes.SELECT}).then(e=>{t.status(200).json(e)}).catch(e=>{t.status(500).send(e)})}),v.post("/api/genres/state",(e,t)=>{t.header("Content-Type","application/json; charset=utf-8");const n=e.body.genreid,s="UPDATE Genres SET state = "+e.body.state+" WHERE id = "+n;a.default.sequelize.query(s,{type:g.a.QueryTypes.UPDATE}).then(()=>{t.status(200).end()}).catch(e=>{t.status(500).send(e)})});var q=v;const I=r.a.Router();I.get("/api/artists",(e,t)=>{t.header("Content-Type","application/json; charset=utf-8");a.default.sequelize.query("SELECT A.id, A.name, A.spotifyId, A.followers, A.popularity, A.state, COUNT(SA.song_id) AS songs, MIN(S.year) AS yearfrom, MAX(S.year) AS yearto FROM SongArtists SA, Artists A, Songs S WHERE SA.artist_id = A.id AND SA.song_id = S.id GROUP BY A.id",{type:g.a.QueryTypes.SELECT}).then(e=>{t.status(200).json(e)}).catch(e=>{t.status(500).send(e)})}),I.post("/api/artists/state",(e,t)=>{t.header("Content-Type","application/json; charset=utf-8");const n=e.body.artistid,s="UPDATE Artists SET state = "+e.body.state+" WHERE id = "+n;a.default.sequelize.query(s,{type:g.a.QueryTypes.UPDATE}).then(()=>{t.status(200).end()}).catch(e=>{t.status(500).send(e)})});var w=I;const x=r.a.Router();x.post("/api/year",(e,t)=>{var n=e.body.song.year;t.header("Content-Type","application/json; charset=utf-8"),a.default.Song.findAll({attributes:["id","filepath","filename","title","album","year","duration"],where:{year:n},include:[{model:a.default.Artist,as:"Artists",attributes:["id","name"],required:!1,through:{attributes:[]}},{model:a.default.Genre,as:"Genres",attributes:["id","name"],required:!1,through:{attributes:[]}}]}).then(e=>t.send(e)).catch(e=>(console.log("There was an error querying songs",JSON.stringify(e)),t.status(500).send(e)))});var M=x;const j=n(25);console.clear(),console.log("__________.__   _____  .__         ________          __          "),console.log("\\______   \\__| /     \\ |__|__  ___ \\______ \\ _____ _/  |______   "),console.log(" |     ___/  |/  \\ /  \\|  \\  \\/  /  |    |  \\\\__  \\\\   __\\__  \\  "),console.log(" |    |   |  /    Y    \\  |>    <   |    `   \\/ __ \\|  |  / __ \\_"),console.log(" |____|   |__\\____|__  /__/__/\\_ \\ /_______  (____  /__| (____  /"),console.log("                     \\/         \\/         \\/     \\/          \\/ v"+j.version),console.log("                 is listening on http port 81"),console.log();const U=n(34);var P=r()();P.use((e,t,n)=>{t.header("Access-Control-Allow-Origin","*"),t.header("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),n()}),P.use(U.json()),P.use(r.a.static(i.a.join(__dirname,"/static"))),P.use(u),P.use(f),P.use(h),P.use(b),P.use(D),P.use(M),P.use(q),P.use(w),P.listen(81,()=>{console.log("> REST API initialized")})}]);