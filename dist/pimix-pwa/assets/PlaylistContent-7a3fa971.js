var w=Object.defineProperty;var V=(e,s,t)=>s in e?w(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var r=(e,s,t)=>(V(e,typeof s!="symbol"?s+"":s,t),t);import{V as D,u as E,s as I,G as g,l as k,M as _,N,O as T,Q as h,_ as q,q as u,o as p,c as d,d as o,U as A,y as b,t as y,n as m,H as C,z as B,T as F,F as L,e as R}from"./index-b74e3224.js";import{V as j,D as K}from"./DragIcon-3ba9d390.js";import{S as G}from"./SongCard-214f4b4b.js";import{O as M}from"./OptionsIcon-5fedd612.js";import"./NotLikedIcon-50ae164a.js";var U=Object.defineProperty,z=Object.getOwnPropertyDescriptor,H=(e,s,t,i)=>{for(var a=i>1?void 0:i?z(s,t):s,c=e.length-1,n;c>=0;c--)(n=e[c])&&(a=(i?n(s,t,a):n(a))||a);return i&&a&&U(s,t,a),a};let f=class extends D{constructor(){super(...arguments);r(this,"appStore",E());r(this,"playlistController",I(()=>N()));r(this,"playlistid");r(this,"playlist",null)}mounted(){g.on("playlist",t=>{switch(t.action){case"refresh":console.log("refresh playlist"),this.getPlaylistContent();break;case"remove":console.log("remove from playlist"),this.removeSongFromPlaylist(t.song);break}})}unmounted(){g.off("playlist")}created(){this.getPlaylistContent()}async getPlaylistContent(){this.playlist=await this.playlistController.requestPlaylist(this.playlistid)}orderChanged(){k.forEach(this.playlist.OrderedSongs,(t,i)=>{t.index=i}),this.playlistController.savePlaylistOrder(this.playlist)}leave(t){t.target.blur()}async remove(){await this.playlistController.deletePlaylist(this.playlistid),this.$router.push({name:"playlists"})}async validate(){this.playlist.name=this.$refs.playlistname.innerText,await this.playlistController.savePlaylist({id:this.playlist.id,public:this.playlist.public,userid:this.playlist.userid,name:this.playlist.name})}async removeSongFromPlaylist(t){await this.playlistController.removeSongFromPlaylist(this.playlistid,t.id),g.emit("playlist",{action:"refresh"})}togglePlaylistPopup(){this.appStore.openPopupProperties([{label:this.$t("command.addqueue"),icon:_(()=>h(()=>import("./index-b74e3224.js").then(t=>t.ag),["assets/index-b74e3224.js","assets/index-f7d88844.css"])),action:()=>{this.appStore.queueOrder(this.playlistid)}},{label:this.$t("command.addrandom"),icon:_(()=>h(()=>import("./OnlyIcon-621dd92c.js"),["assets/OnlyIcon-621dd92c.js","assets/index-b74e3224.js","assets/index-f7d88844.css"])),action:()=>{this.appStore.queueRandom(this.playlistid)}},{label:this.$t("command.delete"),icon:_(()=>h(()=>import("./index-b74e3224.js").then(t=>t.ak),["assets/index-b74e3224.js","assets/index-f7d88844.css"])),action:()=>{this.remove()}}])}};f=H([T({props:{playlistid:Number},components:{SongCard:G,draggable:j,DragIcon:K,OptionsIcon:M}})],f);const Q={key:0,class:"flex flex-col w-full __container__screen"},J={class:"items-center"},W={class:"flex gap-1 mt-1 mb-3"},X={class:"__badge__label"},Y={class:"__badge__label2"},Z={class:"flex mb-2"},x={class:"pr-2"},ee={key:0,class:"__badge__label2 mt-2 text-center justify-center"},se={key:1,class:"grid grid-cols-1 md:gap-2"};function te(e,s,t,i,a,c){var v;const n=u("OptionsIcon"),O=u("DragIcon"),S=u("SongCard"),$=u("draggable");return e.playlist?(p(),d("div",Q,[o("div",J,[o("h1",{ref:"playlistname",contenteditable:"",spellcheck:"false",onClick:s[0]||(s[0]=A(()=>{},["stop"])),onKeydown:s[1]||(s[1]=b((...l)=>e.leave&&e.leave(...l),["esc"])),onKeypress:s[2]||(s[2]=b((...l)=>e.leave&&e.leave(...l),["enter"])),onBlur:s[3]||(s[3]=(...l)=>e.validate&&e.validate(...l))},y(e.playlist.name),545)]),o("div",W,[o("span",X,y(e.playlist.public==1?e.$t("playlist.public"):e.$t("playlist.private")),1),o("span",Y,y(e.$tc("stats.songs",(v=e.playlist.OrderedSongs)==null?void 0:v.length)),1)]),o("div",Z,[o("div",{class:"flex __button__action rounded-r-xl items-center",onClick:s[4]||(s[4]=l=>e.togglePlaylistPopup())},[m(n),o("span",x,y(e.$t("command.action")),1)])]),e.playlist.OrderedSongs.length==0?(p(),d("div",ee,y(e.$t("playlist.empty")),1)):(p(),d("div",se,[m($,{modelValue:e.playlist.OrderedSongs,"onUpdate:modelValue":s[5]||(s[5]=l=>e.playlist.OrderedSongs=l),handle:".handle",class:"flex flex-col p-1 md:p-0 gap-1",onChange:e.orderChanged},{default:C(()=>[m(F,null,{default:C(()=>{var l;return[(p(!0),d(L,null,R((l=e.playlist)==null?void 0:l.OrderedSongs,P=>(p(),d("div",{key:P.song.id,class:"flex truncate cursor-pointer items-center rounded-l-xl rounded-r-xl __icon__action"},[m(O,{class:"__icon__drag ml-1"}),m(S,{class:"w-full",song:P.song,playlist:e.playlist},null,8,["song","playlist"])]))),128))]}),_:1})]),_:1},8,["modelValue","onChange"])]))])):B("",!0)}const de=q(f,[["render",te]]);export{de as default};
