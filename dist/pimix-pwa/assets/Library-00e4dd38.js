var U=Object.defineProperty;var J=(e,s,t)=>s in e?U(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var d=(e,s,t)=>(J(e,typeof s!="symbol"?s+"":s,t),t);import{_ as Y,p as S,b as Z,o as r,c as n,d as i,F as O,e as j,t as o,y as p,n as u,g as D,V as q,u as z,J as Q,K as W,Y as X,s as x,l as g,H as K,N as L,O as ee,Z as se,$ as te,a0 as re,a1 as oe,a2 as ne,w as ie,a3 as ae,U as V}from"./index-29bcaaf6.js";import{S as le}from"./SongsController-5b3077aa.js";import{S as ce}from"./SongCard-877650a7.js";import"./OptionsIcon-bdc80d17.js";import"./NotLikedIcon-07bbc64f.js";var he=Object.defineProperty,de=Object.getOwnPropertyDescriptor,pe=(e,s,t,c)=>{for(var a=c>1?void 0:c?de(s,t):s,m=e.length-1,h;m>=0;m--)(h=e[m])&&(a=(c?h(s,t,a):h(a))||a);return c&&a&&he(s,t,a),a};let f=class extends q{constructor(){super(...arguments);d(this,"appStore",z());d(this,"mixmeStore",Q());d(this,"trackStore",W());d(this,"searchStore",X());d(this,"songsController",x(()=>le()));d(this,"genreids");d(this,"artistids")}mounted(){g.isNil(this.genreids)&&g.isNil(this.artistids)&&this.searchStore.getCookie(),K.on("interface",s=>{switch(s.command){case"onFilterChanged":{this.loadContent();break}case"onFavoriteUpdate":{this.searchStore.sortingKey==="favorites"&&this.loadContent();break}}}),this.loadContent()}unmounted(){K.off("interface")}async loadContent(){this.appStore.startLoading(),this.searchStore.setSearchResults(null),this.$router.currentRoute.value.name==="genre"&&(this.searchStore.clear(),this.searchStore.sortingKey="lastadded",this.searchStore.genreids=g.map(this.genreids.split(","),t=>parseInt(t))),this.$router.currentRoute.value.name==="artist"&&(this.searchStore.clear(),this.searchStore.sortingKey="lastadded",this.searchStore.artistids=g.map(this.artistids.split(","),t=>parseInt(t))),this.searchStore.keywords.length===0&&this.songsController.clearResults();const s={keywords:this.searchStore.keywords,genreids:this.searchStore.genreids,artistids:this.searchStore.artistids,period:{from:this.searchStore.yearFrom,to:this.searchStore.yearTo},sortKey:this.searchStore.sortingKey,sincehours:this.searchStore.sincehours,activeSong:this.trackStore.song,notplayedsinceminutes:this.searchStore.notplayedsinceminutes,limit:this.searchStore.limit};console.debug(">> Get library list",s),await this.songsController.getList(s),s.keywords.length>0?this.searchStore.setSearchResults(this.songsController.songs.length):this.searchStore.setSearchResults(null),this.$router.currentRoute.value.name==="library"&&this.searchStore.setCookie(),this.appStore.endLoading()}longclick(){this.appStore.activeSelectionMode(!0)}songSelected(s){this.appStore.isSelectionActive?this.appStore.selectSong(s):this.appStore.openSongIDCard(s)}cleanKeyword(s){var c;const t=(c=this.searchStore.keywords)==null?void 0:c.trim().split(" ");this.searchStore.keywords=g.remove(t,a=>a.trim()!==s.trim()||a.trim().length===0).join(" "),this.songsController.clearResults(),this.loadContent()}cleanPeriod(){this.searchStore.yearFrom=null,this.searchStore.yearTo=null,this.loadContent()}cleanSinceHours(){this.searchStore.sincehours=0,this.loadContent()}cleanNotPlayedSinceMinutes(){this.searchStore.notplayedsinceminutes=0,this.loadContent()}popupArtists(){this.appStore.openPopupProperties(g.map(this.songsController.searchResults.artists,s=>({label:s.name,icon:L(()=>V(()=>import("./index-29bcaaf6.js").then(t=>t.aj),["assets/index-29bcaaf6.js","assets/index-bf39b48d.css"])),action:()=>{this.$router.push({name:"artist",params:{artistids:s.id}})}})))}popupGenres(){this.appStore.openPopupProperties(g.map(this.songsController.searchResults.genres,s=>({label:s.name,icon:L(()=>V(()=>import("./index-29bcaaf6.js").then(t=>t.aj),["assets/index-29bcaaf6.js","assets/index-bf39b48d.css"])),action:()=>{this.$router.push({name:"genre",params:{genreids:s.id}})}})))}};f=pe([ee({components:{SongCard:ce,CloseIcon:se,TitreIcon:te,ArtistIcon:re,GenreIcon:oe,ScoreIcon:ne},props:{genreids:String,artistids:String,song:Object}})],f);const ue=f,ge={class:"flex flex-col w-full h-full mt-0"},Se={class:"flex flex-col md:flex-row text-center px-1 gap-1 py-1 __container__navigation"},me={class:"flex flex-wrap gap-1"},fe={key:0,class:"flex gap-1 items-center __badge__label"},_e={key:0},ye={key:1},Ce={key:1,class:"flex gap-1 items-center __badge__label"},ve={key:2,class:"flex gap-1 items-center __badge__label"},be={class:"flex flex-wrap gap-1 justify-end"},ke={class:"__badge__label2 flex gap-1 items-center"},we={class:"hidden md:flex"},$e={class:"hidden md:flex"},Ie={class:"md:hidden"},Re={class:"hidden md:flex"},Pe={class:"md:hidden"},Te={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 __container__list"},Ae={key:0,class:"inline-flex m-2 p-10 text-xl justify-center text-center bg-[color:var(--font--active)] text-[color:var(--font--light)] truncate"};function Fe(e,s,t,c,a,m){var _,y,C,v,b,k,w,$,I,R,P,T,A,F;const h=S("CloseIcon"),E=S("TitreIcon"),G=S("ArtistIcon"),B=S("GenreIcon"),M=S("SongCard"),H=Z("longpress");return r(),n("div",ge,[i("div",Se,[i("div",me,[(r(!0),n(O,null,j(e.songsController.keywords,l=>(r(),n("div",{key:`kw-${l}`,class:"flex items-center __badge__label"},[D(o(l)+" ",1),u(h,{class:"cursor-pointer w-4 h-4",onClick:N=>e.cleanKeyword(l)},null,8,["onClick"])]))),128)),((_=e.searchStore.yearFrom)==null?void 0:_.length)>0||((y=e.searchStore.yearTo)==null?void 0:y.length)>0?(r(),n("div",fe,[((C=e.searchStore.yearFrom)==null?void 0:C.length)>0?(r(),n("span",_e,o(e.$tc(((v=e.searchStore.yearTo)==null?void 0:v.length)>0?"library.filtering.periodfrom":"library.filtering.periodafter"))+" "+o(e.searchStore.yearFrom),1)):p("",!0),((b=e.searchStore.yearTo)==null?void 0:b.length)>0?(r(),n("span",ye,o(e.$tc(((k=e.searchStore.yearFrom)==null?void 0:k.length)>0?"library.filtering.periodfromto":"library.filtering.periodto"))+" "+o(e.searchStore.yearTo),1)):p("",!0),u(h,{class:"cursor-pointer",onClick:e.cleanPeriod},null,8,["onClick"])])):p("",!0),e.searchStore.sincehours>0?(r(),n("div",Ce,[i("span",null,o(e.$tc("library.filtering.history",{hours:e.searchStore.sincehours})),1),u(h,{class:"cursor-pointer",onClick:e.cleanSinceHours},null,8,["onClick"])])):p("",!0),e.searchStore.notplayedsinceminutes>0?(r(),n("div",ve,[i("span",null,o(e.$tc("library.filtering.notplayedsince",{minutes:e.searchStore.notplayedsinceminutes})),1),u(h,{class:"cursor-pointer",onClick:e.cleanNotPlayedSinceMinutes},null,8,["onClick"])])):p("",!0)]),i("div",be,[i("span",ke,[u(E,{class:"w-4 h-4"}),i("span",we,o(e.$t("stats.songs")),1),D(" "+o((w=e.songsController.songs)==null?void 0:w.length),1)]),(($=e.songsController.searchResults.artists)==null?void 0:$.length)>0?(r(),n("span",{key:0,class:"__badge__label2 flex gap-1 items-center cursor-pointer",onClick:s[0]||(s[0]=l=>e.popupArtists())},[u(G,{class:"w-4 h-4"}),i("span",$e,o(e.$tc("library.filtering.resultartist",((I=e.songsController.searchResults.artists)==null?void 0:I.length)||0)),1),i("span",Ie,o(((R=e.songsController.searchResults.artists)==null?void 0:R.length)||0),1)])):p("",!0),((P=e.songsController.searchResults.genres)==null?void 0:P.length)>0?(r(),n("span",{key:1,class:"__badge__label2 flex gap-1 items-center cursor-pointer",onClick:s[1]||(s[1]=l=>e.popupGenres())},[u(B,{class:"w-4 h-4"}),i("span",Re,o(e.$tc("library.filtering.resultgenre",((T=e.songsController.searchResults.genres)==null?void 0:T.length)||0)),1),i("span",Pe,o(((A=e.songsController.searchResults.genres)==null?void 0:A.length)||0),1)])):p("",!0)])]),i("div",Te,[(r(!0),n(O,null,j(e.songsController.songs,(l,N)=>(r(),n("div",{key:N,class:"flex truncate cursor-pointer"},[ie((r(),ae(M,{key:l.id,class:"w-full",song:l,onClick:Ne=>e.songSelected(l)},null,8,["song","onClick"])),[[H,e.longclick]])]))),128)),((F=e.songsController.songs)==null?void 0:F.length)==0?(r(),n("div",Ae,o(e.$t("library.filtering.noresult")),1)):p("",!0)])])}const Ee=Y(ue,[["render",Fe]]);export{Ee as default};
