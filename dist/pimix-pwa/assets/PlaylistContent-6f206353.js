var w=Object.defineProperty;var V=(s,e,t)=>e in s?w(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var r=(s,e,t)=>(V(s,typeof e!="symbol"?e+"":e,t),t);import{_ as D,p as u,o as p,c as d,d as o,M as E,x as P,t as y,n as m,B as C,y as I,V as k,u as B,s as N,H as g,l as T,N as _,O as A,T as F,F as q,e as L,Q as R,U as h}from"./index-29bcaaf6.js";import{V as j,D as K}from"./DragIcon-6a428e20.js";import{S as M}from"./SongCard-877650a7.js";import{O as U}from"./OptionsIcon-bdc80d17.js";import"./NotLikedIcon-07bbc64f.js";var G=Object.defineProperty,H=Object.getOwnPropertyDescriptor,Q=(s,e,t,i)=>{for(var a=i>1?void 0:i?H(e,t):e,c=s.length-1,n;c>=0;c--)(n=s[c])&&(a=(i?n(e,t,a):n(a))||a);return i&&a&&G(e,t,a),a};let f=class extends k{constructor(){super(...arguments);r(this,"appStore",B());r(this,"playlistController",N(()=>R()));r(this,"playlistid");r(this,"playlist",null)}mounted(){g.on("playlist",e=>{switch(e.action){case"refresh":console.log("refresh playlist"),this.getPlaylistContent();break;case"remove":console.log("remove from playlist"),this.removeSongFromPlaylist(e.song);break}})}unmounted(){g.off("playlist")}created(){this.getPlaylistContent()}async getPlaylistContent(){this.playlist=await this.playlistController.requestPlaylist(this.playlistid)}orderChanged(){T.forEach(this.playlist.OrderedSongs,(e,t)=>{e.index=t}),this.playlistController.savePlaylistOrder(this.playlist)}leave(e){e.target.blur()}async remove(){await this.playlistController.deletePlaylist(this.playlistid),this.$router.push({name:"playlists"})}async validate(){this.playlist.name=this.$refs.playlistname.innerText,await this.playlistController.savePlaylist({id:this.playlist.id,public:this.playlist.public,userid:this.playlist.userid,name:this.playlist.name})}async removeSongFromPlaylist(e){await this.playlistController.removeSongFromPlaylist(this.playlistid,e.id),g.emit("playlist",{action:"refresh"})}togglePlaylistPopup(){this.appStore.openPopupProperties([{label:this.$t("command.addqueue"),icon:_(()=>h(()=>import("./index-29bcaaf6.js").then(e=>e.ag),["assets/index-29bcaaf6.js","assets/index-bf39b48d.css"])),action:()=>{this.appStore.queueOrder(this.playlistid)}},{label:this.$t("command.addrandom"),icon:_(()=>h(()=>import("./OnlyIcon-86fbede4.js"),["assets/OnlyIcon-86fbede4.js","assets/index-29bcaaf6.js","assets/index-bf39b48d.css"])),action:()=>{this.appStore.queueRandom(this.playlistid)}},{label:this.$t("command.delete"),icon:_(()=>h(()=>import("./index-29bcaaf6.js").then(e=>e.ak),["assets/index-29bcaaf6.js","assets/index-bf39b48d.css"])),action:()=>{this.remove()}}])}};f=Q([A({props:{playlistid:Number},components:{SongCard:M,draggable:j,DragIcon:K,OptionsIcon:U}})],f);const x=f,z={key:0,class:"flex flex-col w-full __container__screen"},J={class:"items-center"},W={class:"flex gap-1 mt-1 mb-3"},X={class:"__badge__label"},Y={class:"__badge__label2"},Z={class:"flex mb-2"},ee={class:"pr-2"},se={key:0,class:"__badge__label2 mt-2 text-center justify-center"},te={key:1,class:"grid grid-cols-1 md:gap-2"};function le(s,e,t,i,a,c){var v;const n=u("OptionsIcon"),O=u("DragIcon"),S=u("SongCard"),$=u("draggable");return s.playlist?(p(),d("div",z,[o("div",J,[o("h1",{ref:"playlistname",contenteditable:"",spellcheck:"false",onClick:e[0]||(e[0]=E(()=>{},["stop"])),onKeydown:e[1]||(e[1]=P((...l)=>s.leave&&s.leave(...l),["esc"])),onKeypress:e[2]||(e[2]=P((...l)=>s.leave&&s.leave(...l),["enter"])),onBlur:e[3]||(e[3]=(...l)=>s.validate&&s.validate(...l))},y(s.playlist.name),545)]),o("div",W,[o("span",X,y(s.playlist.public==1?s.$t("playlist.public"):s.$t("playlist.private")),1),o("span",Y,y(s.$tc("stats.songs",(v=s.playlist.OrderedSongs)==null?void 0:v.length)),1)]),o("div",Z,[o("div",{class:"flex __button__action rounded-r-xl items-center",onClick:e[4]||(e[4]=l=>s.togglePlaylistPopup())},[m(n),o("span",ee,y(s.$t("command.action")),1)])]),s.playlist.OrderedSongs.length==0?(p(),d("div",se,y(s.$t("playlist.empty")),1)):(p(),d("div",te,[m($,{modelValue:s.playlist.OrderedSongs,"onUpdate:modelValue":e[5]||(e[5]=l=>s.playlist.OrderedSongs=l),handle:".handle",class:"flex flex-col p-1 md:p-0 gap-1",onChange:s.orderChanged},{default:C(()=>[m(F,null,{default:C(()=>{var l;return[(p(!0),d(q,null,L((l=s.playlist)==null?void 0:l.OrderedSongs,b=>(p(),d("div",{key:b.song.id,class:"flex truncate cursor-pointer items-center rounded-l-xl rounded-r-xl __icon__action"},[m(O,{class:"__icon__drag ml-1"}),m(S,{class:"w-full",song:b.song,playlist:s.playlist},null,8,["song","playlist"])]))),128))]}),_:1})]),_:1},8,["modelValue","onChange"])]))])):I("",!0)}const de=D(x,[["render",le]]);export{de as default};
