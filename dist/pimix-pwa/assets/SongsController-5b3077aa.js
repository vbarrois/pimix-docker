import{u as p,r as m,a7 as u,Y as w,J as S,K as R,R as i,ae as h,l as d}from"./index-29bcaaf6.js";const k=o=>new Promise(s=>{h("api/songs/all",o).then(t=>{s(d.map(t.data,n=>n))}).catch(()=>{s([])})}),y=o=>new Promise(s=>{h("api/search",{keywords:o}).then(t=>{console.debug("search",t.data),s(t.data)}).catch(()=>{s([])})}),x=o=>{let s=h("api/quiz/next",o);return new Promise(t=>{s.then(n=>{t(d.map(n.data,g=>g))}).catch(()=>{t([])})})},f=()=>{const o=p(),s=m({songs:[],searchResults:{},count:u(()=>s.songs.length)});async function t(e){var c,a;if(((c=e.keywords)==null?void 0:c.length)>0){s.searchResults=await y(e.keywords),s.keywords=s.searchResults.keywords,s.songs=s.searchResults.songs;const r=w();r.artistids=[],r.genreids=[]}else s.keywords="",s.songs=await k({...e,userids:[((a=o.user)==null?void 0:a.id)|0]})}async function n(){var r;const e=S(),c=R(),a={sessionid:(r=e.server)==null?void 0:r.sessionid,current:c.song,nextmode:"samegenre",count:4};s.songs=await x(a)}const g=e=>`http://${i}/api/song/thumb/${e}`,l=e=>`http://${i}/api/song/cover/${e}`;return{songs:u(()=>s.songs),searchResults:u(()=>s.searchResults),keywords:u(()=>s.keywords),getPages:e=>{var a,r;return Math.floor(((a=s.songs)==null?void 0:a.length)/e)+(((r=s.songs)==null?void 0:r.length)%e>0?1:0)},clearResults:()=>{s.keywords="",s.searchResults={}},getList:t,getQuiz:n,getCover:l,getThumb:g}};export{f as S};
